<!DOCTYPE html>
<html>
<head>
<title>Monthly Dashboard</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- FontAwesome -->
<link rel="stylesheet" 
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- Chart JS -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
.chart-card{ height: 430px; }
.chart-container{ height: 330px; }

.gradient-nav{
background: linear-gradient(90deg,#667eea,#764ba2);
}
</style>
</head>

<body class="bg-light">

<!-- NAVBAR (SAME AS MAIN) -->
<nav class="navbar navbar-expand-lg navbar-dark gradient-nav">
<div class="container-fluid">

<a class="navbar-brand" href="/dashboard/">FinVision AI</a>

<div class="d-flex align-items-center">

<a href="/dashboard/" 
class="btn btn-outline-light me-2">
<i class="fa-solid fa-house"></i> Main Dashboard
</a>

<button class="btn btn-outline-light me-2" 
onclick="toggleDark()">ðŸŒ™</button>

<div class="dropdown">
<button class="btn btn-light dropdown-toggle" 
data-bs-toggle="dropdown">
<i class="fa-solid fa-user"></i> {{ request.user }}
</button>

<ul class="dropdown-menu dropdown-menu-end">
<li><a class="dropdown-item" href="#">Profile</a></li>
<li><hr class="dropdown-divider"></li>
<li>
<form method="post" action="/accounts/logout/">
{% csrf_token %}
<button class="dropdown-item">
<i class="fa-solid fa-right-from-bracket"></i> Logout
</button>
</form>
</li>
</ul>
</div>

</div>
</div>
</nav>

<!-- MAIN -->
<div class="container mt-4">

<h4><i class="fa-solid fa-calendar"></i> Monthly Tracking</h4>

<!-- FILTER -->
<form method="get" class="row mb-3">

<div class="col-md-3">
<input type="month" name="month" 
class="form-control" required>
</div>

<div class="col">
<button class="btn btn-primary">
<i class="fa-solid fa-filter"></i> Filter
</button>
</div>

</form>

{% if selected_month %}
<div class="alert alert-info">
Showing data for: <b>{{ selected_month }}</b>
</div>
{% endif %}

<!-- CARDS -->
<div class="row">

<div class="col-md-4">
<div class="card shadow-sm">
<div class="card-body">
<h5><i class="fa-solid fa-wallet"></i> Total spent</h5>
<h3>â‚¹ {{ total }}</h3>
</div>
</div>
</div>

</div>

<!-- CHART -->
<div class="row mt-4">

<div class="col-md-6">
<div class="card shadow-sm p-3 chart-card">
<h5>Where your money went</h5>
<div class="chart-container">
<canvas id="pieChart"></canvas>
</div>
</div>
</div>

</div>

</div>

<!-- LOAD DATA -->
<script>
var categories = {{ categories|safe }};
var amounts = {{ amounts|safe }};
</script>

<!-- PIE -->
<script>
new Chart(document.getElementById('pieChart'), {
type:'pie',
data:{
labels:categories,
datasets:[{data:amounts}]
},
options:{
responsive:true,
maintainAspectRatio:false,
animation:{duration:1500}
}
});
</script>

<!-- DARK MODE -->
<script>
function toggleDark(){
document.body.classList.toggle("bg-dark");
document.body.classList.toggle("text-white");
}
</script>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
